# Bison_Element_Models
R code and Stan code for statistical models of bison element frequencies in Early Holocene archaeological contexts.

This is a work in progress, please feel free to notify me of any errors or to make suggestions. Currently, this project is tailored to
modelling bison element frequencies in Early Holocene archaeological contexts in North America, but, in principle, it could be 
extended to any spatiotemporal context where differential carcass transport decisions are of archaeological interest. Current features
of the code are specific to the bison dataset, but I hope to make this more generalizeable for other contexts in the future.
<br><br>
<b>To fit these models</b>, ensure that your working directory includes the 'Data' and 'Stan models' folders. First, run <i>01_data_preprocessing.R</i>. This script aggregates the information from spreadsheets stored in the 'Data' folder and outputs and RData file (<i>01_Out.RData</i>) that contains an R list object to be used as input for either Stan model.<br><br>
Next, decide which Stan model you would like to fit. The first model, <i>m1v2nc.stan</i>, fits a single-predictor model to each dietary utility predictor as well as the bone density predictor, comprising 8 model fits. The second model, <i>m2v2nc.stan</i>, fits a two-predictor model to each dietary utility predictor + the bone density predictor, comprising 7 model fits. For the former set of model fits, run <i>02_fit_Stan_models_01.R</i>, and for the latter set of model fits, run <i>02_fit_Stan_models_02.R</i>. You will need to ensure that <i>01_Out.RData</i> and the 'Stan models' folder, with its Stan files, are both located in the working directory.<br><br>
Both <i>02_fit_Stan_models_0X.R</i> scripts are set up to work across multiple cores. One chain per model is assigned to a core, with four chains per model (2500 sampling and 7500 warmup iterations per chain). As such, for the single-predictor model with 8 fits, the entire set of models can be fit in parallel if 32 (8x4) cores are avilable. For the two-predictor model with 7 fits, the entire set of models can be fitted if 28 (7x4) cores are available. Although these can be run on a personal computer, substantial speed advantages will be present on most computing cluster nodes, as these often contain many more cores than a personal computer.<br><br>
During model fitting, an 'Out' subdirectory will be created in the 'Stan models' folder. In this subidrectory, the script will continuously output to text files for each Stan model fit. This is the standard Stan model progress output that is displayed when fitting Stan models in R. In this context, since multiple Stan models are being fitted in parallel, you can monitor the progress of each model fit as lines are written to the text file specific to that fit. For the single predictor models, chains generally run for 1.5-2.5 hours, depending on the predictor specific to the model fit (the density data take a bit longer than the dietary utility data). For the two-predictor models, chains generally run for 4-5 hours.<br><br>
<b>DATA</b><br><br>
<b>MNE_Data.csv:</b> This sheet contains the archaeological data of interest. Rows are individual site components, containing MNE data and other component specific information, such as site type, element counts, and reference information. Also, note, one row contains information for anatomical frequencies rather than component specific information. There is additional information in this spreadsheet that is not used in the current R or Stan code that I intend to build into other models. Also, note components from later assemblages that are not used in the current models. Currently the R code excludes these components from the models, but in the future, I intend to exand this model beyond Early Holocene contexts.<br><br>
<b>Utility_Data.csv:</b> This sheet contains data from Emerson's (1990) disseration work on the dietary utility of bison carcass portions. There is a column of data for each individual animal that Emerson analyzed. The dietary utility indexes in this sheet include grease utility (GRE), total fat utility (TF_), select fat utility (SF_), skeletal fat utility (SKF), marrow utility (MAR), protein/meat utility (PRO), and total products utility (TP_).<br><br>
<b>Density_Data.csv:</b> This sheet contains data from Kreutzer's (1992) dissertation work on the volume density of scan site locations on bison elements.<br><br>
<b>AdjDensity_Data.csv</b> This sheet contains data from Lam et al.'s (1999) study of CT density values on element scan sites from numerous taxa. Specifically, this sheet contains their data from wildebeest. Their study demonstrated that earlier density measurements used by zooarchaeologists frequently underestimated the density values of elements with voids (e.g., the marrow cavities of long bones). This includes Kreutzer's data. Lam et al. (1999) provide density values for elements both with and without consideration for internal voids. As such, I use these values to provide a rough correction for Kreutzer's bison data, rescaling values for those elements so that their densities are not underestimated. Since Lam et al. (1999) did not measure bison, I used their wildebeest data, as they are likely to be most comparable to the bison data since both animals are bovids (the relative differences between values incorporating voids and those excluding voids are likely to be more similar between bison and wildebeest than they are to be between bison and any other taxon in Lam et al.'s study).
